# ds1 - Data Science learning from BelHard Academy

# HomeWork 6 (hw6_view.ipynb)
Взят набор данных по социальному опросу содержащий 20 типов независимых вопросов, 
дату прохождения опроса и тональность ответов (негативная, нейтральная, позитивная).

Формат данных:
- Дата в формате DATA (преобразована в формат datetime64[ns] и группировка в DatetimeIndex для выборки временного ряда),
- Коды вопросов формат string (использовались преобразования для EDA анализа One-Hot Encoding, Frequency Encoding и группировка с датой для выборки временного ряда), 
- Тональность (int64 со значениями -1,0,1)

Проведен EDA анализ данных и их преобразования.

Осуществлен анализ временного ряда с выбором лучшей модели pycaret.time_series, а также тесты нескольких других моделей.
Из-за небольшого размера датасета после группировки с датой для выборки временного ряда, пришлось экспериментально подбирать количество тренировочной и тестовой выборок.

Лучшая модель с учетом подбора данных:
- Exponential Smoothing с параметрами (seasonal='add', sp=7, trend='add')

Также тестировались: 
- Theta Forecaster, 
- Arima, 
- Light Gradient Boosting, 
- K Neighbors

Произведена детекция аномалий с помощью модели iforest (с подбором параметра contamination) из библиотеки pycaret.anomaly

Построены графики и диаграммы.


# HomeWork 5 (hw5_view.ipynb)

Реализовать минимум 5 регрессоров, сравнить метрики между собой, выбрать лучший для своего датасета.

Выбран датасет: Обзор годовых отчетов о заработной плате (Anual Salary reports survey)

Заработная плата для определения корреляции между годовой зарплатой, возрастом, полом, уровнем образования

https://www.kaggle.com/datasets/micheldc55/anual-salary-reports-survey/data

Использовались алгоритмы регресии:
- LGBM Regressor
- LGBM Regressor с подбором параметров GridSearchCV
- Extra TreesR egressor
- Bayesian Ridge Regression
- Decision Tree Regressor
- Orthogonal Matching Pursuit
- ElasticNet

Наиболее эффективными являются LGBMRegressor, Extra Trees Regressor, DecisionTreeRegressor.

LGBM с подбором параметров показал чуть лучшие результаты, но подббор занимает много времени.

<b>Метрики использованных алгоритмов регрессии</b>

*****************
Метрики качества модели LGBM :
*****************
- Средняя абсолютная ошибка (MAE): 6731.22
- Среднеквадратичная ошибка (MSE): 77809807.32
- Корень среднеквадратичной ошибки (RMSE): 8820.99
- Коэффициент детерминации (R²): 0.33
- Затрачено времени на Регрессор LGBM: 1.507021427154541 сек

*****************
Метрики качества модели LGBM с подбором параметров:
*****************
- Средняя абсолютная ошибка (MAE): 6726.95
- Среднеквадратичная ошибка (MSE): 77781398.59
- Корень среднеквадратичной ошибки (RMSE): 8819.38
- Коэффициент детерминации (R²): 0.33
- Затрачено времени на Регрессор LGBM с подбором параметров: 479.5257649421692 сек

*****************
Метрики качества модели Extra Trees Regressor:
*****************
- Средняя абсолютная ошибка (MAE): 6731.90
- Среднеквадратичная ошибка (MSE): 77303859.59
- Корень среднеквадратичной ошибки (RMSE): 8792.26
- Коэффициент детерминации (R²): 0.33
- Затрачено времени на Регрессор ExtraTreesRegressor: 2.2869508266448975 сек

*****************
Метрики качества модели Bayesian Ridge Regression:
*****************
- Средняя абсолютная ошибка (MAE): 6968.71
- Среднеквадратичная ошибка (MSE): 86591074.74
- Корень среднеквадратичной ошибки (RMSE): 9305.43
- Коэффициент детерминации (R²): 0.25
- Затрачено времени на Регрессор Bayesian Ridge Regression: 0.02931809425354004 сек

*****************
Метрики качества модели DecisionTreeRegressor:
*****************
- Средняя абсолютная ошибка (MAE): 6731.90
- Среднеквадратичная ошибка (MSE): 77303866.06
- Корень среднеквадратичной ошибки (RMSE): 8792.26
- Коэффициент детерминации (R²): 0.33
- Затрачено времени на  DecisionTreeRegressor: 0.047952890396118164 сек

*****************
Метрики качества модели OrthogonalMatchingPursuit (Ортогональный поиск соответствия):
*****************
- Средняя абсолютная ошибка (MAE): 7031.32
- Среднеквадратичная ошибка (MSE): 90363874.00
- Корень среднеквадратичной ошибки (RMSE): 9505.99
- Коэффициент детерминации (R²): 0.22
- Затрачено времени на  OrthogonalMatchingPursuit: 0.009980440139770508 сек

*****************
Метрики качества модели ElasticNet:
*****************
- Средняя абсолютная ошибка (MAE): 6962.36
- Среднеквадратичная ошибка (MSE): 86612149.00
- Корень среднеквадратичной ошибки (RMSE): 9306.56
- Коэффициент детерминации (R²): 0.25
- Затрачено времени на  ElasticNet: 0.017691612243652344 сек
  

# HomeWork 4 (hw4_view.ipynb)

Реализовать минимум 5 классификаторов, сравнить метрики между собой, выбрать лучший для Вашего датасета.

Задание: Загрузите набор данных о посетителях веб-сайта (например, набор данных Online Shoppers) и обучите модель классификации для предсказания, будет ли посетитель совершать покупку.

https://www.kaggle.com/datasets/imakash3011/online-shoppers-purchasing-intention-dataset

Набор данных о намерениях совершения покупок онлайн-покупателями от UCI

Есть существенный дисбаланс классов примерно 5:1 0(отказ от покупки):1(совершение покупки)

Использовались алгоритмы классификации:
- AdaBoost
- ExtraTrees (с использованием GridSearchCV для подбора гиперпараметров)
- DummyClassifier
- KNeighbors
- KNeighbors (c настройкой гиперпараметров кол-ва соседей GridSearchCV)
- SVM Метод опорных векторов (с дополнительной стандартизацией признаков StandardScaler)

Наилучшие показатели по метрикам и матрице ошибок для данного датасета 
показал алгоритм AdaBoost

Также измерялось время работы каждого алгоритма

*******

Набор данных состоит из векторов признаков, принадлежащих 12 330 сеансам. 
Набор данных был сформирован таким образом, чтобы каждый сеанс принадлежал другому пользователю в течение 1 года, чтобы избежать любой тенденции к определенной кампании, особому дню, профилю пользователя или периоду.

Набор данных состоит из 10 числовых и 8 категориальных атрибутов.
Атрибут Revenue «Доход» использовался в качестве метки класса.

<h5>Поля:</h5>
0.   Administrative --- Административная
1.   Administrative_Duration --- Административная продолжительность
2.  Informational --- Информационная
3.   Informational_Duration --- Информационная продолжительность
4.   ProductRelated --- Связанные с продуктом
5.   ProductRelated_Duration --- Связанные с продолжительностью продукта
6.   BounceRates --- Показатели отказов
7.   ExitRates --- Показатели выхода
8.   PageValues --- Значение страницы
9.   SpecialDay --- Особый день
10.  Month --- Месяц
11.  OperatingSystems --- Операционные системы
12.  Browser --- Браузер
13.  Region --- Регион
14.  TrafficType --- Тип трафика
15.  VisitorType --- Тип посетителя
16.  Weekend --- Выходные
17.  Revenue --- Доход





# HomeWork 3 (hw3_view.ipynb) 
1. Выберите любой открытый датасет и скачайте открытый датасет, соответствующий вашим интересам или области обучения.
2. Создайте новую базу данных в системе управления базами данных (например, SQLite, PostgreSQL).
3. Создайте таблицу (или несколько таблиц) в базе данных с различными типами данных (INTEGER, TEXT, DATE), которые требуются для вашего датасета. Импортируйте данные из датасета в созданные таблицы.
4. Напишите несколько SQL-запросов для извлечения данных из таблиц базы данных. Используйте условия фильтрации (например, WHERE) для получения нужных данных.
5. Напишите SQL-запросы, использующие агрегатные функции (SUM, AVG, COUNT) для выполнения расчетов по данным таблицы.
6. Визуализируйте данные. Используйте библиотеки Python, такие как Matplotlib или Seaborn, для визуализации данных, извлеченных из базы данных. Постройте графики или диаграммы, которые помогут проанализировать и понять данные.

<h3>Power Consumption Prediction Dataset</h3>
<h5>Power consumption of three different distribution networks</h5>
This dataset is related to power consumption of three different distribution networks of Tetouan city which is located in north Morocco.

 - 0   DateTime               52416 non-null  object 
 - 1   Temperature            52416 non-null  float64
 - 2   Humidity               52416 non-null  float64
 - 3   Wind Speed             52416 non-null  float64
 - 4   general diffuse flows  52416 non-null  float64
 - 5   diffuse flows          52416 non-null  float64
 - 6   Zone 1                 52416 non-null  float64
 - 7   Zone 2                 52416 non-null  float64
 - 8   Zone 3                 52416 non-null  float64


# HomeWork 2 (hw2_view.ipynb)
1. Создайте модуль data_loader для загрузки данных из различных источников (CSV, JSON, API)
2. Создайте методы для добавления и удаления различных типов визуализации, таких как гистограммы, линейные графики и диаграммы рассеяния. Реализуйте эти методы. 
3. Создайте метод для подсчета пустых или пропущенных значений в каждом столбце DataFrame, а также метод для вывода отчета с информацией о пропущенных значениях. Реализуйте метод заполнения пропущенных значений (например: средним, медианой или наиболее частым значением).
4. Датасет выбрать самостоятельно исходя из интересов

<h3>Dataset on Anxiety Attacks</h3>
- ID
- Age  18 to 64
- Gender (Male, Female, Other)
- Occupation - Job role
- Sleep Hours - Daily sleep duration
- Physical Activity (hrs/week) (Exercise duration)
- Caffeine Intake (mg/day)
- Alcohol Consumption (drinks/week) drinks/week
- Smoking Yes/No
- Family History of Anxiety Yes/No

<h4>Модули</h4>
- hw2_modules/data_loader.py (класс загрузки датасета и получение его в формате DataFrame)
- hw2_modules/eda_analyze.py (класс для анализа, графического отображения, восстановления данных датасета)
 
<h4>Датасет</h4>
- anxiety_attack_data

# HomeWork 1 (hw1_view.ipynb)
